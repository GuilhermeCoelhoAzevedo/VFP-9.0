FUNC USUARIOCORRENTE
********************
	*RETORNA O USUARIO CORRENTE DO SISTEMA OPERACIONAL
	*retorna: string
	LOCAL lcUSER AS STRING
	lcUSER = ALLTRIM(STREXTRACT(SYS(0),'#',''))
RETURN(lcUSER)

FUNC CALCIDADE
**************
	LPARAMETERS tnANONASC, tdCALCULO
	* Calcula e retorna a idade de um cavalo
	* Retorna: integer

	IF VARTYPE(tnANONASC)='D'
		* CONVERTER. CASO RECEBA O ANO EM FORMATO DE DATA
		tnANONASC = YEAR(tnANONASC)
	ENDIF

	IF VARTYPE(tnANONASC)<>'N'
		RETURN(-1)
	ENDIF

	IF VARTYPE(tdCALCULO)<>'D'
		tdCALCULO = DATE()
	ENDIF

	LOCAL lnIDADE AS Integer
	lnIDADE = YEAR(tdCALCULO) - tnANONASC
	IF lnIDADE<0
		lnIDADE = 0
	ENDIF

RETURN(lnIDADE)

FUNC DIA_SEMANA
***************
LPARAMETERS tdDATA
	LOCAL lnOCO AS Integer
	lnOCO = DOW(tdDATA)
	LOCAL lcDIA AS STRING
	lcDIA = STREXTRACT(' DOM SEG TER QUA QUI SEX SAB ',' ',' ',lnOCO)
RETURN(lcDIA)

FUNC PEGA_PROPOSTAS
*******************
LPARAMETERS ldMINIMA
	IF VARTYPE(ldMINIMA)
		ldMINIMA = CTOD('')
	ENDIF
	LOCAL lnQF AS INTEGER
	lnQF = ADIR(laFILES,'G:\TRAB\PROPOSTA\*.DOCX')
	
	LOCAL lcLISTA, lcARQ AS String
	lcLISTA = ''

	FOR lnX = 1 TO lnQF
		ldARQ = laFILES[ lnX, 3]
		IF ldARQ < ldMINIMA
			LOOP
		ENDIF
		lcARQ = laFILES[ lnX, 1]
		lcLISTA = lcLISTA + lcARQ + CHR(13)
	ENDFOR
RETURN(lcLISTA)

